<app-adminheader></app-adminheader>


<div class="page-body-wrapper">
    <app-adminsidebar></app-adminsidebar>

    <div class="main-panel">
        <div class="content-wrapper">
            <div class="card" style="display:none">
                <div class="card-body">
                    <div class="titleSec">
                        <!-- <h2>Search Coupon</h2>  -->
                          
                        <form [formGroup]="__cupon_type"> 
                          <mat-radio-group formControlName="cupon_type" color="primary">
                            <mat-radio-button value="B">Book Specific</mat-radio-button>
                            <mat-radio-button value="G" class="ml-3">General</mat-radio-button>
                          </mat-radio-group>
                        </form>
                        <button type="button" class="btn btn-primary" (click)="addCard()">Create Coupon</button>
                    </div>
                    <!-- <form #logform="ngForm" (ngSubmit)="submitForm(logform)">
                    <div class="row">
                        <div class="col-4">
                            <mat-form-field appearance="outline">
                          
                                <mat-label>Book Name</mat-label>
                                <mat-select name="book_name" #book_name="ngModel" ngModel >
                                  <mat-option value="" [selected]="this.b_id==''">Select</mat-option>
                                  <mat-option  *ngFor="let books of allBooks" [selected]="books.book_id==this.b_id" [value]="books.book_id">
                                    {{books.book_name}} | {{books.isbn_no}}
                                  </mat-option>
                                </mat-select>

                              </mat-form-field>       

                        </div>
                        <div class="col-4">
                          <mat-form-field appearance="outline">
                            <mat-label>Start Date</mat-label>
                             <input matInput type="date" name="startDate" #startDate="ngModel" ngModel/>
                           
                          </mat-form-field>
                        </div>
                        <div class="col-4">
                          <mat-form-field appearance="outline">
                            <mat-label>End Date</mat-label>
                             <input matInput type="date" name="endDate" #endDate="ngModel" ngModel/>
                          </mat-form-field>
                        </div>
                        <div class="col-4">
                          <mat-form-field appearance="outline">
                            <mat-label>Token</mat-label>
                             <input matInput type="text" name="temp_book_id" #temp_book_id="ngModel" ngModel/>
                          </mat-form-field>
                        </div>

                        <div class="col-8 mt-3 btnSubmitSec">
                            <input type="submit" value='Search' class="btn btn-info float-right"/>
                        </div>
                         </div>
                    </form> -->

                </div>

            </div>
            <div id="cover-spin" *ngIf="loader">
            </div>
            <!-- id="showTable" -->
            <div class="card" >
                <div class="card-body">
                  <div class="titleSec">
                    <!-- <h2>Coupon Details</h2> -->
                    <!-- <a (click)="showHide('T')" class="fs-3 float-right">
                      <i class="fa fa-times  text-muted" aria-hidden="true"></i></a> -->
                      <form [formGroup]="__cupon_type"> 
                        <mat-radio-group formControlName="cupon_type" color="primary">
                          <mat-radio-button value="B">Book Specific</mat-radio-button>
                          <mat-radio-button value="G" class="ml-3">General</mat-radio-button>
                        </mat-radio-group>
                      </form>
                      <button type="button" class="btn btn-primary" (click)="addCard()">Create Coupon</button>
                    </div>

                      <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
                      
                        <ng-container matColumnDef="No">
                          <th mat-header-cell *matHeaderCellDef> No. </th>
                          <td mat-cell *matCellDef="let element;let i=index" >{{i+1}}</td>
                        </ng-container>
                      

                        <ng-container matColumnDef="name">
                          <th mat-header-cell *matHeaderCellDef> Book / Temporary Book </th>
                          <td mat-cell *matCellDef="let element">
                            {{element.book_details ? element.book_details.book_name : element.temp_book_name}}
                          </td>
                        </ng-container>
                     

                        <ng-container matColumnDef="book_id">
                          <th mat-header-cell *matHeaderCellDef> Book ID/ Token </th>
                          <td mat-cell *matCellDef="let element">
                            {{element.book_details ? element.book_details.book_id : element.temp_book_id}}
                          </td>
                        </ng-container>

                            <!-- <ng-container matColumnDef="coupon_code">
                                <th mat-header-cell *matHeaderCellDef> Coupon Code </th>
                                <td mat-cell *matCellDef="let element">{{element.coupon_code}}</td>
                              </ng-container> -->

                        <ng-container matColumnDef="startDate">
                            <th mat-header-cell *matHeaderCellDef> Coupon Date </th>
                            <td mat-cell *matCellDef="let element">
                              {{element.coupon_from_date | date:'dd/MM/YYYY'}} - {{element.coupon_to_date | date:'dd/MM/YYYY'}}</td>
                          </ng-container>


                        <!-- <ng-container matColumnDef="endDate">
                            <th mat-header-cell *matHeaderCellDef>Coupon End Date </th>
                            <td mat-cell *matCellDef="let element">{{element.coupon_to_date}}</td>
                          </ng-container> -->

                        <ng-container matColumnDef="bookstartDate">
                          <th mat-header-cell *matHeaderCellDef>Book Date </th>
                          <td mat-cell *matCellDef="let element">{{element.book_from_date | date:'dd/MM/YYYY'}} - {{element.book_to_date | date:'dd/MM/YYYY'}}</td>
                        </ng-container>


                        <ng-container matColumnDef="generated date">
                          <th mat-header-cell *matHeaderCellDef>Created At</th>
                          <td mat-cell *matCellDef="let element">
                            <!-- <a (click)="downloadPdf()"> -->
                              {{element.created_at | date:'dd/MM/YYYY'}}
                            <!-- </a> -->
                          </td>
                        </ng-container>


                        <ng-container matColumnDef="total coupon">
                          <th mat-header-cell *matHeaderCellDef>Total coupon</th>
                          <td mat-cell *matCellDef="let element">
                            <!-- <a (click)="downloadPdf()"> -->
                              {{element.total_coupon}}
                            <!-- </a> -->
                          </td>
                        </ng-container>

  
                        <ng-container matColumnDef="Action">
                        <th mat-header-cell *matHeaderCellDef>Coupons </th>
                        <td mat-cell *matCellDef="let element">
                          <!-- <a *ngIf="element.book_id!=''" (click)="download(element)">
                            <i title="dowload" class="fa fa-download" aria-hidden="true"></i></a> -->
                            <button mat-icon-button *ngIf="element.book_id!=''" (click)="download(element)">
                              <mat-icon>download</mat-icon>
                            </button>
                          <p *ngIf="element.book_id==''">{{element.coupon_code}}</p>
                        </td>
                      </ng-container>

                      <!-- <ng-container matColumnDef="CouponList" [hidden]="this.b_id==''">
                        <th mat-header-cell *matHeaderCellDef>Coupon Code </th>
                        <td mat-cell *matCellDef="let element">
                          {{element.coupon_code}}
                        </td>
                      </ng-container> -->

                      
                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                      
                 
                        <tr class="mat-row" *matNoDataRow>
                          <td class="mat-cell" colspan="8" class="text-center">No data matching </td>
                        </tr>
                      </table>
                      <div id="BoarddivToPrint_1">  
                        <table id="tables" >
                          <!-- <thead>
                            <tr class="text-center">
                              <img src="/assets/adminassets/images/logoAdmin.png">
                            </tr>
                            <tr class="text-center">
                              <h4 class="text-center">{{book_name}}</h4>
                            </tr>
                            <tr class="text-center">
                              <h5 class="text-center">by {{auth_name}}</h5>
                            </tr>
                            <tr class="text-center">
                              <h5 class="text-center">{{isbn}}</h5>
                            </tr>
                          </thead> -->
                          <thead>
                           
                            <tr>
                              <th>Sl No.</th>
                              <th>Coupon Code</th>
                              <th>Coupon Date</th>
                              <th>Book Date</th>
                              <th>Created At</th>
                            </tr>
                          </thead>
                          <tbody *ngFor="let coupons of allcoupons;let i=index">
                            <tr>
                              <td>{{i+1}}</td>
                              <td>{{coupons.coupon_code}}</td>
                              <td>{{coupons.coupon_from_date | date:'dd/MM/YYYY'}} - {{coupons.coupon_to_date | date:'dd/MM/YYYY'}}</td>
                              <td>{{coupons.book_from_date | date:'dd/MM/YYYY'}} - {{coupons.book_to_date | date:'dd/MM/YYYY'}}</td>
                              <td>{{coupons.created_at | date:'dd/MM/YYYY'}}</td>

                            </tr>
                          </tbody>
                        </table>
             
                     
                     
                      </div>
                      <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>

                      <div class="row mt-3">
                        <div class="col-12  btnSubmitSec text-center">
                            <!-- <button class="btn btn-info pdfButton" (click)="downloadPdf()" [disabled]="base_dt.length == 0">PDF</button> -->
                        </div>
                      </div>
                </div>
            </div> 
        </div>
    </div>
</div>
